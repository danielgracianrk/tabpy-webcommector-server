2020-05-11,15:39:22 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    #return df\n    return pd.DataFrame(first_row_json)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,15:39:22 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     #return df
     return pd.DataFrame(first_row_json)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,15:39:22 [ERROR] (base_handler.py:base_handler:121): Responding with status=500, message="Error processing script", info="TypeError : list indices must be integers or slices, not str"
2020-05-11,15:39:22 [ERROR] (web.py:web:2250): 500 POST /evaluate (127.0.0.1) 59.02ms
2020-05-11,15:39:22 [ERROR] (base_handler.py:base_handler:121): Responding with status=500, message="Error processing script", info="TypeError : list indices must be integers or slices, not str"
2020-05-11,15:39:22 [ERROR] (web.py:web:2250): 500 POST /evaluate (127.0.0.1) 59.11ms
2020-05-11,15:39:26 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,15:39:26 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,15:39:26 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,15:39:26 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,15:39:26 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,15:39:26 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:39:26 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,15:39:26 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:39:26 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,15:39:26 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:39:26 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    #return df\n    return pd.DataFrame(first_row_json)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,15:39:26 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     #return df
     return pd.DataFrame(first_row_json)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,15:39:26 [ERROR] (base_handler.py:base_handler:121): Responding with status=500, message="Error processing script", info="TypeError : list indices must be integers or slices, not str"
2020-05-11,15:39:26 [ERROR] (web.py:web:2250): 500 POST /evaluate (127.0.0.1) 29.58ms
2020-05-11,15:39:26 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,15:39:26 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,15:39:26 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,15:39:26 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,15:39:26 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,15:39:26 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:39:26 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,15:39:26 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:39:26 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,15:39:26 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:39:26 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    #return df\n    return pd.DataFrame(first_row_json)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,15:39:26 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     #return df
     return pd.DataFrame(first_row_json)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,15:39:26 [ERROR] (base_handler.py:base_handler:121): Responding with status=500, message="Error processing script", info="TypeError : list indices must be integers or slices, not str"
2020-05-11,15:39:26 [ERROR] (web.py:web:2250): 500 POST /evaluate (127.0.0.1) 31.82ms
2020-05-11,15:40:36 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,15:40:36 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,15:40:36 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,15:40:36 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,15:40:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,15:40:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:40:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,15:40:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:40:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,15:40:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:40:36 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    #return df\n    return pd.DataFrame(first_row_json)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,15:40:36 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     #return df
     return pd.DataFrame(first_row_json)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,15:40:36 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 26.46ms
2020-05-11,15:40:36 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,15:40:36 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,15:40:36 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,15:40:36 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,15:40:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,15:40:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:40:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,15:40:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:40:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,15:40:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:40:36 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    #return df\n    return pd.DataFrame(first_row_json)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,15:40:36 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     #return df
     return pd.DataFrame(first_row_json)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,15:40:36 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 31.93ms
2020-05-11,15:40:36 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,15:40:36 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,15:40:36 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,15:40:36 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,15:40:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,15:40:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:40:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,15:40:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:40:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,15:40:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:40:36 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    #return df\n    return pd.DataFrame(first_row_json)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,15:40:36 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     #return df
     return pd.DataFrame(first_row_json)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,15:40:36 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,15:40:37 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,15:40:37 [ERROR] (base_handler.py:base_handler:121): Responding with status=500, message="Error processing script", info="ValueError : If using all scalar values, you must pass an index"
2020-05-11,15:40:37 [ERROR] (web.py:web:2250): 500 POST /evaluate (127.0.0.1) 1108.82ms
2020-05-11,15:42:26 [CRITICAL] (app.py:app:117): Exiting on signal 2...
2020-05-11,15:42:26 [INFO] (app.py:app:123): Shutting down TabPy...
2020-05-11,15:42:26 [INFO] (app.py:app:123): Shutting down TabPy...
2020-05-11,15:42:35 [DEBUG] (app.py:app:206): Parameter port set to "9004" from default value
2020-05-11,15:42:35 [DEBUG] (app.py:app:206): Parameter server_version set to "1.0.0" from default value
2020-05-11,15:42:35 [DEBUG] (app.py:app:206): Parameter evaluate_timeout set to "30" from default value
2020-05-11,15:42:35 [DEBUG] (app.py:app:206): Parameter upload_dir set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tmp/query_objects" from default value
2020-05-11,15:42:35 [DEBUG] (app.py:app:206): Parameter transfer_protocol set to "http" from default value
2020-05-11,15:42:35 [DEBUG] (app.py:app:212): Parameter certificate_file is not set
2020-05-11,15:42:35 [DEBUG] (app.py:app:212): Parameter key_file is not set
2020-05-11,15:42:35 [DEBUG] (app.py:app:206): Parameter state_file_path set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server" from default value
2020-05-11,15:42:35 [DEBUG] (app.py:app:206): Parameter static_path set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server/static" from default value
2020-05-11,15:42:35 [DEBUG] (app.py:app:212): Parameter TABPY_PWD_FILE is not set
2020-05-11,15:42:35 [DEBUG] (app.py:app:206): Parameter log_request_context set to "false" from default value
2020-05-11,15:42:35 [DEBUG] (app.py:app:206): Parameter max_request_size_in_mb set to "100" from default value
2020-05-11,15:42:35 [INFO] (app.py:app:436): Loading state from state file /Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server/state.ini
2020-05-11,15:42:35 [DEBUG] (app.py:app:315): Static pages folder set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server/static"
2020-05-11,15:42:35 [INFO] (app.py:app:334): Password file is not specified: Authentication is not enabled
2020-05-11,15:42:35 [INFO] (app.py:app:348): Call context logging is disabled
2020-05-11,15:42:35 [INFO] (app.py:app:125): Initializing TabPy...
2020-05-11,15:42:35 [DEBUG] (selector_events.py:selector_events:58): Using selector: KqueueSelector
2020-05-11,15:42:35 [INFO] (callbacks.py:callbacks:43): Initializing TabPy Server...
2020-05-11,15:42:35 [DEBUG] (state.py:state:596): Loading option 'None' from section [Query Objects Service Versions]...
2020-05-11,15:42:35 [DEBUG] (state.py:state:616): Returning value '[]'
2020-05-11,15:42:35 [DEBUG] (state.py:state:148): Collected endpoints: {}
2020-05-11,15:42:35 [INFO] (app.py:app:129): Done initializing TabPy.
2020-05-11,15:42:35 [INFO] (app.py:app:83): Setting max request size to 104857600 bytes
2020-05-11,15:42:35 [INFO] (callbacks.py:callbacks:64): Initializing models...
2020-05-11,15:42:35 [DEBUG] (state.py:state:596): Loading option 'None' from section [Query Objects Service Versions]...
2020-05-11,15:42:35 [DEBUG] (state.py:state:616): Returning value '[]'
2020-05-11,15:42:35 [DEBUG] (state.py:state:148): Collected endpoints: {}
2020-05-11,15:42:35 [INFO] (app.py:app:107): Web service listening on port 9004
2020-05-11,15:43:18 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,15:43:18 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,15:43:18 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,15:43:18 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,15:43:18 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,15:43:18 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:18 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,15:43:18 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:18 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,15:43:18 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:18 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    #return df\n    return pd.DataFrame(first_row_json)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,15:43:18 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     #return df
     return pd.DataFrame(first_row_json)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,15:43:19 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 420.08ms
2020-05-11,15:43:19 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,15:43:19 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,15:43:19 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,15:43:19 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,15:43:19 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,15:43:19 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:19 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,15:43:19 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:19 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,15:43:19 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:19 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    #return df\n    return pd.DataFrame(first_row_json)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,15:43:19 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     #return df
     return pd.DataFrame(first_row_json)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,15:43:19 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 33.12ms
2020-05-11,15:43:22 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,15:43:22 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,15:43:22 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,15:43:22 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,15:43:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,15:43:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,15:43:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,15:43:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:22 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    #return df\n    return pd.DataFrame(first_row_json)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,15:43:22 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     #return df
     return pd.DataFrame(first_row_json)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,15:43:22 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 41.00ms
2020-05-11,15:43:22 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,15:43:22 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,15:43:22 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,15:43:22 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,15:43:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,15:43:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,15:43:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,15:43:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:22 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    #return df\n    return pd.DataFrame(first_row_json)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,15:43:22 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     #return df
     return pd.DataFrame(first_row_json)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,15:43:22 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 99.16ms
2020-05-11,15:43:30 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,15:43:30 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,15:43:30 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,15:43:30 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,15:43:30 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,15:43:30 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:30 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,15:43:30 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:30 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,15:43:30 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:30 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    #return df\n    return pd.DataFrame(first_row_json)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,15:43:30 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     #return df
     return pd.DataFrame(first_row_json)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,15:43:30 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 33.10ms
2020-05-11,15:43:30 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,15:43:30 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,15:43:30 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,15:43:30 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,15:43:30 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,15:43:30 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:30 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,15:43:30 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:30 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,15:43:30 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:30 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    #return df\n    return pd.DataFrame(first_row_json)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,15:43:30 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     #return df
     return pd.DataFrame(first_row_json)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,15:43:30 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 39.32ms
2020-05-11,15:43:30 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,15:43:30 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,15:43:30 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,15:43:30 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,15:43:30 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,15:43:30 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:30 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,15:43:30 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:30 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,15:43:30 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,15:43:30 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    #return df\n    return pd.DataFrame(first_row_json)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,15:43:30 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     #return df
     return pd.DataFrame(first_row_json)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,15:43:30 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,15:43:31 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,15:43:31 [ERROR] (base_handler.py:base_handler:121): Responding with status=500, message="Error processing script", info="NameError : name 'first_row_json' is not defined"
2020-05-11,15:43:31 [ERROR] (web.py:web:2250): 500 POST /evaluate (127.0.0.1) 716.16ms
2020-05-11,16:01:14 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:14 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:14 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:14 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:14 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:14 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:14 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 9.80ms
2020-05-11,16:01:14 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:14 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:14 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:14 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:14 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:14 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:14 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 11.63ms
2020-05-11,16:01:16 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:16 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:16 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:16 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:16 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:16 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:16 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:16 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:16 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:16 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:16 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:16 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:16 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 8.98ms
2020-05-11,16:01:16 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:16 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:16 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:16 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:16 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:16 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:16 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:16 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:16 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:16 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:16 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:16 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:16 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 9.87ms
2020-05-11,16:01:20 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:20 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:20 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:20 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:20 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:20 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:20 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:20 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:20 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:20 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:20 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:20 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:20 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 9.16ms
2020-05-11,16:01:20 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:20 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:20 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:20 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:20 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:20 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:20 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:20 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:20 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:20 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:20 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:20 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:20 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 10.05ms
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:28 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:28 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:28 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 32.46ms
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:28 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 16.25ms
2020-05-11,16:01:28 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:28 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:28 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:28 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 39.12ms
2020-05-11,16:01:28 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 28.67ms
2020-05-11,16:01:28 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 28.61ms
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:28 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:28 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 12.84ms
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:28 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:28 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:28 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['http://127.0.0.1:3000/api/datahub/v1/article/content-folder/referrals?id=2.7560&id=2.7605&from=2020-04-01T05%3A58%3A05.283Z&to=2020-04-01T09%3A59%3A35.014Z&publishedInsideDateRange=false']}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\nexecution_result = get_query_json(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:01:28 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 execution_result = get_query_json(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:01:28 [DEBUG] (connectionpool.py:connectionpool:230): Starting new HTTP connection (1): 127.0.0.1:3000
2020-05-11,16:01:29 [DEBUG] (connectionpool.py:connectionpool:442): http://127.0.0.1:3000 "GET /api/datahub/v1/article/content-folder/referrals?id=2.7560&id=2.7605&from=2020-04-01T05%3A58%3A05.283Z&to=2020-04-01T09%3A59%3A35.014Z&publishedInsideDateRange=false HTTP/1.1" 200 None
2020-05-11,16:01:30 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 1589.44ms
2020-05-11,16:01:32 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:32 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:32 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:32 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:32 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:32 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:32 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:32 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:32 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:32 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:32 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:32 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:33 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 8.57ms
2020-05-11,16:01:33 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:33 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:33 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:33 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:33 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:33 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:33 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:33 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:33 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:33 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:33 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:01:33 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:01:33 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 8.81ms
2020-05-11,16:01:33 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:01:33 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:01:33 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:01:33 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:01:33 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:01:33 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:33 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:01:33 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:33 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:01:33 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:01:33 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['http://127.0.0.1:3000/api/datahub/v1/article/content-folder/referrals?id=2.7560&id=2.7605&from=2020-04-01T05%3A58%3A05.283Z&to=2020-04-01T09%3A59%3A35.014Z&publishedInsideDateRange=false']}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\nimport json\n\nkeys_csv = \'\'\nfirst_row_json = \'\'\n\ndef set_first_row(input):\n    global first_row_json # Needed to modify global copy of globvar\n    first_row_json = input\n\ndef get_first_row():\n    global first_row_json\n    return first_row_json\n\n\ndef set_globvar(input):\n    global keys_json  # Needed to modify global copy of globvar\n    global first_row_json\n    print(input)\n    if input == "Init":\n        keys_json = input\n    else:\n        keys_json = input.keys()\n    first_row_json = input\n\n\ndef get_globvar():\n    global keys_json\n    return keys_json\n\ndef get_query_json(url):\n    url = f\'{url.iloc[0]["url"]}\'\n    response = requests.get(url)\n    response = json.loads(response.text)\n    set_globvar(response["referrals"][0])\n    #set_first_row(response["referrals"][0])\n\n    data = list()\n    for item in response["referrals"]:\n        data.append(item)\n    # set_globvar(next(iter).decode(\'utf-8\').split(\';\'))\n    # print(pd.DataFrame(data, columns=get_globvar()))\n    return pd.DataFrame(data, columns=get_globvar())\n\ndef get_output_schema():\n    print("INIT")\n    if not "keys_json" in globals():\n        print("KEYS_INIT")\n        set_globvar("Init")\n\n    keys_json = get_globvar()\n\n    #keys = [\'INGR_CHANNELS.ATTR_NAME\', \'CALC_DPS.UNIT_RTG\', \'CALC_DPS.UNIT_RTGPCT\', \'CALC_DPS.UNIT_SHR\']\n\n    first_row_json = get_first_row()\n    dict = {}\n    if keys_json == \'Init\':\n        for i in keys_json:\n            dict[i] = prep_string()\n    else:\n        for i in keys_json:\n            print(i)\n            if isinstance(first_row_json[i], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n\n    return pd.DataFrame(dict)\nexecution_result = get_query_json(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:01:33 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 import json
 
 keys_csv = ''
 first_row_json = ''
 
 def set_first_row(input):
     global first_row_json # Needed to modify global copy of globvar
     first_row_json = input
 
 def get_first_row():
     global first_row_json
     return first_row_json
 
 
 def set_globvar(input):
     global keys_json  # Needed to modify global copy of globvar
     global first_row_json
     print(input)
     if input == "Init":
         keys_json = input
     else:
         keys_json = input.keys()
     first_row_json = input
 
 
 def get_globvar():
     global keys_json
     return keys_json
 
 def get_query_json(url):
     url = f'{url.iloc[0]["url"]}'
     response = requests.get(url)
     response = json.loads(response.text)
     set_globvar(response["referrals"][0])
     #set_first_row(response["referrals"][0])
 
     data = list()
     for item in response["referrals"]:
         data.append(item)
     # set_globvar(next(iter).decode('utf-8').split(';'))
     # print(pd.DataFrame(data, columns=get_globvar()))
     return pd.DataFrame(data, columns=get_globvar())
 
 def get_output_schema():
     print("INIT")
     if not "keys_json" in globals():
         print("KEYS_INIT")
         set_globvar("Init")
 
     keys_json = get_globvar()
 
     #keys = ['INGR_CHANNELS.ATTR_NAME', 'CALC_DPS.UNIT_RTG', 'CALC_DPS.UNIT_RTGPCT', 'CALC_DPS.UNIT_SHR']
 
     first_row_json = get_first_row()
     dict = {}
     if keys_json == 'Init':
         for i in keys_json:
             dict[i] = prep_string()
     else:
         for i in keys_json:
             print(i)
             if isinstance(first_row_json[i], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
 
     return pd.DataFrame(dict)
 execution_result = get_query_json(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:01:33 [DEBUG] (connectionpool.py:connectionpool:230): Starting new HTTP connection (1): 127.0.0.1:3000
2020-05-11,16:01:33 [DEBUG] (connectionpool.py:connectionpool:442): http://127.0.0.1:3000 "GET /api/datahub/v1/article/content-folder/referrals?id=2.7560&id=2.7605&from=2020-04-01T05%3A58%3A05.283Z&to=2020-04-01T09%3A59%3A35.014Z&publishedInsideDateRange=false HTTP/1.1" 200 None
2020-05-11,16:01:33 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 421.79ms
2020-05-11,16:06:06 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:06:06 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:06:06 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:06:06 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:06:06 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:06:06 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:06:06 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:06:06 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:06:06 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:06:06 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:06:06 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:06:06 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:06:06 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 31.48ms
2020-05-11,16:06:06 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:06:06 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:06:06 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:06:06 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:06:06 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:06:06 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:06:06 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:06:06 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:06:06 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:06:06 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:06:06 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:06:06 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:06:07 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 27.47ms
2020-05-11,16:06:07 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:06:07 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:06:07 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:06:07 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:06:07 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:06:07 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:06:07 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:06:07 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:06:07 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:06:07 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:06:07 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:06:07 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:06:07 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,16:06:08 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,16:06:08 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 1048.19ms
2020-05-11,16:10:00 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:10:00 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:10:00 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:10:00 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:10:00 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:10:00 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:00 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:10:00 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:00 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:10:00 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:00 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    iter = response.iter_lines()\n    a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:10:00 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     iter = response.iter_lines()
     a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:10:00 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 25.04ms
2020-05-11,16:10:00 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:10:00 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:10:00 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:10:00 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:10:00 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:10:00 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:00 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:10:00 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:00 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:10:00 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:00 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    iter = response.iter_lines()\n    a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:10:00 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     iter = response.iter_lines()
     a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:10:00 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 30.67ms
2020-05-11,16:10:00 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:10:00 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:10:00 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:10:00 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:10:00 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:10:00 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:00 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:10:00 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:00 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:10:00 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:00 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    iter = response.iter_lines()\n    a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:10:00 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     iter = response.iter_lines()
     a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:10:00 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,16:10:01 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,16:10:01 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 772.30ms
2020-05-11,16:10:38 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:10:38 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:10:38 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:10:38 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:10:38 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:10:38 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:38 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:10:38 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:38 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:10:38 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:38 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    iter = response.iter_lines()\n    a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:10:38 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     iter = response.iter_lines()
     a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:10:38 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 25.62ms
2020-05-11,16:10:38 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:10:38 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:10:38 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:10:38 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:10:38 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:10:38 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:38 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:10:38 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:38 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:10:38 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:10:38 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    iter = response.iter_lines()\n    a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:10:38 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     iter = response.iter_lines()
     a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:10:38 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 27.07ms
2020-05-11,16:11:02 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:11:02 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:11:02 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:11:02 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:11:02 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:11:02 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:02 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:11:02 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:02 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:11:02 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:02 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:11:02 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:11:02 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 29.87ms
2020-05-11,16:11:02 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:11:02 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:11:02 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:11:02 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:11:02 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:11:02 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:02 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:11:02 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:02 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:11:02 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:02 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:11:02 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:11:02 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 29.38ms
2020-05-11,16:11:03 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:11:03 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:11:03 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:11:03 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:11:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:11:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:11:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:11:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:03 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:11:03 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:11:03 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,16:11:03 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:11:03 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:11:03 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:11:03 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:11:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:11:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:11:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:11:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:03 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:11:03 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:11:03 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 30.47ms
2020-05-11,16:11:03 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:11:03 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:11:03 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:11:03 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:11:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:11:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:11:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:11:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:11:03 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:11:03 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:11:04 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 39.88ms
2020-05-11,16:11:04 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,16:11:04 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 1233.24ms
2020-05-11,16:24:40 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:24:40 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:24:40 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:24:40 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:24:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:24:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:24:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:24:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:40 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:24:40 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:24:40 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 37.89ms
2020-05-11,16:24:40 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:24:40 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:24:40 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:24:40 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:24:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:24:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:24:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:24:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:40 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:24:40 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:24:40 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 34.52ms
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:24:49 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:24:49 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 47.04ms
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:24:49 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:24:49 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:24:49 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 48.22ms
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:24:49 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:24:49 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 73.75ms
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:24:49 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 42.64ms
2020-05-11,16:24:49 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:24:49 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:24:49 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 51.54ms
2020-05-11,16:24:49 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 60.55ms
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:24:49 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:24:49 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:49 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:24:49 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:24:49 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,16:24:50 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,16:24:50 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 753.10ms
2020-05-11,16:24:53 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:24:53 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:24:53 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:24:53 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:24:53 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:24:53 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:53 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:24:53 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:53 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:24:53 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:53 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:24:53 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:24:53 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 31.19ms
2020-05-11,16:24:53 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:24:53 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:24:53 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:24:53 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:24:53 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:24:53 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:53 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:24:53 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:53 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:24:53 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:53 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:24:53 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:24:54 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 32.01ms
2020-05-11,16:24:57 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:24:57 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:24:57 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:24:57 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:24:57 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:24:57 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:57 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:24:57 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:57 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:24:57 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:57 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:24:57 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:24:57 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 32.78ms
2020-05-11,16:24:57 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:24:57 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:24:57 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:24:57 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:24:57 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:24:57 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:57 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:24:57 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:57 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:24:57 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:24:57 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(i)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:24:57 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(i)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:24:57 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 31.35ms
2020-05-11,16:25:14 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:14 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:14 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:14 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:14 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(count)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:25:14 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(count)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:25:14 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 24.25ms
2020-05-11,16:25:14 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:14 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:14 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:14 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:14 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(count)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:25:14 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(count)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:25:14 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 28.48ms
2020-05-11,16:25:14 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:14 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:14 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:14 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:14 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:14 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:14 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(count)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:25:14 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(count)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:25:14 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,16:25:15 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,16:25:15 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 624.93ms
2020-05-11,16:25:20 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:20 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:20 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:20 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:20 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:20 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:20 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:20 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:20 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:20 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:20 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(count)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:25:20 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(count)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:25:20 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 28.43ms
2020-05-11,16:25:20 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:20 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:20 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:20 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:20 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:20 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:20 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:20 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:20 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:20 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:20 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(count)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:25:20 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(count)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:25:20 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 32.99ms
2020-05-11,16:25:23 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:23 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:23 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:23 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:23 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:23 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:23 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:23 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:23 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:23 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:23 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(count)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:25:23 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(count)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:25:23 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 24.50ms
2020-05-11,16:25:23 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:23 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:23 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:23 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:23 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:23 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:23 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:23 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:23 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:23 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:23 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(count)\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:25:23 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(count)
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:25:23 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 32.21ms
2020-05-11,16:25:34 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:34 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:34 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:34 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:34 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:34 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:34 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:34 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:34 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:34 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:34 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count])\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:25:34 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count])
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:25:34 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 28.02ms
2020-05-11,16:25:34 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:34 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:34 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:34 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:34 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:34 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:34 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:34 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:34 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:34 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:34 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count])\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:25:34 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count])
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:25:34 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 25.30ms
2020-05-11,16:25:34 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:34 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:34 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:34 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:34 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:34 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:34 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:34 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:34 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:34 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:34 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count])\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:25:34 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count])
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:25:34 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,16:25:35 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,16:25:35 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 509.11ms
2020-05-11,16:25:37 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:37 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:37 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:37 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:37 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count])\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:25:37 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count])
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:25:37 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 27.22ms
2020-05-11,16:25:37 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:37 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:37 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:37 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:37 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count])\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:25:37 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count])
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:25:37 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 22.78ms
2020-05-11,16:25:59 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:59 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:59 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:59 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:59 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:59 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:59 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:59 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:59 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:59 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:59 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:25:59 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:25:59 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 29.92ms
2020-05-11,16:25:59 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:59 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:59 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:59 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:59 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:59 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:59 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:59 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:59 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:59 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:59 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:25:59 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:25:59 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 27.86ms
2020-05-11,16:25:59 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:25:59 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:25:59 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:25:59 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:25:59 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:25:59 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:59 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:25:59 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:59 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:25:59 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:25:59 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:25:59 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:25:59 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,16:26:00 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,16:26:00 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 718.85ms
2020-05-11,16:26:03 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:26:03 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:26:03 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:26:03 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:26:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:26:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:26:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:26:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:26:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:26:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:26:03 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:26:03 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:26:03 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 27.88ms
2020-05-11,16:26:03 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:26:03 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:26:03 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:26:03 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:26:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:26:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:26:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:26:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:26:03 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:26:03 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:26:03 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:26:03 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:26:03 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 35.82ms
2020-05-11,16:34:40 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:34:40 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:34:40 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:34:40 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:34:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:34:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:34:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:34:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:34:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:34:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:34:40 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:34:40 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:34:40 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 33.61ms
2020-05-11,16:34:40 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:34:40 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:34:40 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:34:40 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:34:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:34:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:34:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:34:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:34:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:34:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:34:40 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:34:40 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:34:40 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 55.51ms
2020-05-11,16:34:42 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:34:42 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:34:42 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:34:42 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:34:42 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:34:42 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:34:42 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:34:42 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:34:42 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:34:42 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:34:42 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:34:42 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:34:42 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 27.46ms
2020-05-11,16:34:42 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:34:42 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:34:42 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:34:42 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:34:42 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:34:42 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:34:42 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:34:42 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:34:42 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:34:42 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:34:42 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if isinstance(first_row_csv[count], int):\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:34:42 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if isinstance(first_row_csv[count], int):
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:34:42 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 31.26ms
2020-05-11,16:40:25 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:40:25 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:40:25 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:40:25 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:40:25 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:40:25 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:25 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:40:25 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:25 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:40:25 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:25 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:40:25 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:40:25 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 28.24ms
2020-05-11,16:40:25 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:40:25 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:40:25 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:40:25 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:40:25 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:40:25 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:25 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:40:25 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:25 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:40:25 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:25 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:40:25 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:40:25 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 23.23ms
2020-05-11,16:40:25 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:40:25 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:40:25 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:40:25 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:40:25 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:40:25 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:25 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:40:25 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:25 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:40:25 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:25 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:40:25 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:40:25 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,16:40:26 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,16:40:26 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 784.23ms
2020-05-11,16:40:31 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:40:31 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:40:31 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:40:31 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:40:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:40:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:40:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:40:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:31 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:40:31 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:40:31 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 31.12ms
2020-05-11,16:40:31 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:40:31 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:40:31 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:40:31 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:40:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:40:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:40:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:40:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:31 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:40:31 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:40:31 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 25.38ms
2020-05-11,16:40:31 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:40:31 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:40:31 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:40:31 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:40:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:40:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:40:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:40:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:40:31 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(isinstance(first_row_csv[count], int))\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:40:31 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(isinstance(first_row_csv[count], int))
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:40:31 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,16:40:32 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,16:40:32 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 398.45ms
2020-05-11,16:59:37 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:59:37 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:59:37 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:59:37 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:59:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:59:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:59:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:59:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:37 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count].isnumeric())\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:59:37 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count].isnumeric())
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:59:37 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 25.98ms
2020-05-11,16:59:37 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:59:37 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:59:37 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:59:37 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:59:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:59:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:59:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:59:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:37 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count].isnumeric())\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:59:37 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count].isnumeric())
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:59:37 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 28.11ms
2020-05-11,16:59:37 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:59:37 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:59:37 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:59:37 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:59:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:59:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:59:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:37 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:59:37 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:37 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count].isnumeric())\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:59:37 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count].isnumeric())
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:59:37 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,16:59:38 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,16:59:38 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 1108.76ms
2020-05-11,16:59:40 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:59:40 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:59:40 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:59:40 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:59:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:59:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:59:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:59:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:40 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count].isnumeric())\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:59:40 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count].isnumeric())
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:59:40 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 29.13ms
2020-05-11,16:59:40 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:59:40 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:59:40 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:59:40 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:59:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:59:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:59:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:59:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:40 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count].isnumeric())\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:59:40 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count].isnumeric())
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:59:40 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 31.58ms
2020-05-11,16:59:40 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:59:40 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:59:40 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:59:40 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:59:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:59:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:59:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:40 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:59:40 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:40 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count].isnumeric())\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:59:40 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count].isnumeric())
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:59:40 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,16:59:41 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,16:59:41 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 775.63ms
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:59:45 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count].isnumeric())\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count].isnumeric())
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:59:45 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 39.03ms
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:59:45 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count].isnumeric())\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count].isnumeric())
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:59:45 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count].isnumeric())\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count].isnumeric())
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:59:45 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 78.90ms
2020-05-11,16:59:45 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count].isnumeric())\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count].isnumeric())
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:59:45 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 61.80ms
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:59:45 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 51.38ms
2020-05-11,16:59:45 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count].isnumeric())\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count].isnumeric())
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:59:45 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count].isnumeric())\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count].isnumeric())
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,16:59:45 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 47.83ms
2020-05-11,16:59:45 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 52.77ms
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,16:59:45 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,16:59:45 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,16:59:45 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            print(first_row_csv[count].isnumeric())\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,16:59:45 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             print(first_row_csv[count].isnumeric())
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,16:59:45 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,16:59:45 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,16:59:45 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 414.81ms
2020-05-11,17:04:43 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:04:43 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:04:43 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:04:43 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:04:43 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:04:43 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:43 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:04:43 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:43 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:04:43 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:43 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:04:43 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:04:43 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 30.01ms
2020-05-11,17:04:43 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:04:43 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:04:43 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:04:43 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:04:43 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:04:43 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:43 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:04:43 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:43 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:04:43 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:43 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:04:43 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:04:43 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 40.38ms
2020-05-11,17:04:43 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:04:43 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:04:43 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:04:43 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:04:43 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:04:43 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:43 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:04:43 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:43 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:04:43 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:43 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,17:04:43 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,17:04:43 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,17:04:44 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,17:04:44 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 721.85ms
2020-05-11,17:04:48 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:04:48 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:04:48 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:04:48 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:04:48 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:04:48 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:48 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:04:48 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:48 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:04:48 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:48 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:04:48 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:04:48 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 31.61ms
2020-05-11,17:04:48 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:04:48 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:04:48 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:04:48 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:04:48 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:04:48 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:48 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:04:48 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:48 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:04:48 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:48 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:04:48 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:04:48 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 29.89ms
2020-05-11,17:04:48 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:04:48 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:04:48 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:04:48 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:04:48 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:04:48 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:48 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:04:48 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:48 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:04:48 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:04:48 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,17:04:48 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,17:04:48 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,17:04:48 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,17:04:48 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 579.75ms
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:01 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:01 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:05:01 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 68.25ms
2020-05-11,17:05:01 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 40.28ms
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:01 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:01 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:01 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 80.06ms
2020-05-11,17:05:01 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:05:01 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 76.82ms
2020-05-11,17:05:01 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 54.58ms
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:01 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:05:01 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 39.11ms
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:01 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:01 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:01 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,17:05:01 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,17:05:01 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,17:05:02 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,17:05:02 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 669.97ms
2020-05-11,17:05:05 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:05 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:05 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:05 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:05 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:05 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:05 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:05 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:05 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:05 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:05 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:05:05 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:05:05 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 24.79ms
2020-05-11,17:05:05 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:05 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:05 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:05 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:05 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:05 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:05 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:05 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:05 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:05 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:05 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:05:05 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:05:05 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 28.56ms
2020-05-11,17:05:05 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:05 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:05 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:05 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:05 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:05 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:05 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:05 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:05 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:05 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:05 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isdecimal:\n                dict[i] = prep_decimal()\n            elif first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,17:05:05 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isdecimal:
                 dict[i] = prep_decimal()
             elif first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,17:05:05 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,17:05:06 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,17:05:06 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 706.90ms
2020-05-11,17:05:22 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:22 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:22 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:22 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:22 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:05:22 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:05:22 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 43.28ms
2020-05-11,17:05:22 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:22 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:22 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:22 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:22 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:05:22 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:05:22 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 49.51ms
2020-05-11,17:05:22 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:22 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:22 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:22 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:22 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:22 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:22 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,17:05:22 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,17:05:22 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,17:05:22 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,17:05:22 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 575.33ms
2020-05-11,17:05:31 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:31 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:31 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:31 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:31 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:05:31 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:05:31 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 34.29ms
2020-05-11,17:05:31 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:31 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:31 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:31 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:31 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:05:31 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:05:31 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 35.31ms
2020-05-11,17:05:31 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:05:31 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:05:31 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:05:31 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:05:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:05:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:05:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:05:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:05:31 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,17:05:31 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,17:05:31 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,17:05:32 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,17:05:32 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 595.75ms
2020-05-11,17:06:09 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:06:09 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:06:09 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:06:09 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:06:09 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:06:09 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:09 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:06:09 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:09 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:06:09 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:09 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:06:09 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:06:09 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 35.34ms
2020-05-11,17:06:09 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:06:09 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:06:09 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:06:09 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:06:09 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:06:09 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:09 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:06:09 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:09 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:06:09 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:09 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:06:09 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:06:09 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 24.96ms
2020-05-11,17:06:09 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:06:09 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:06:09 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:06:09 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:06:09 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:06:09 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:09 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:06:09 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:09 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:06:09 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:09 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,17:06:09 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,17:06:09 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,17:06:10 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,17:06:10 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 932.32ms
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:06:39 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:06:39 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 44.76ms
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:06:39 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:06:39 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:06:39 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:06:39 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 82.65ms
2020-05-11,17:06:39 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 90.89ms
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:06:39 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 74.83ms
2020-05-11,17:06:39 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:06:39 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,17:06:39 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 53.10ms
2020-05-11,17:06:39 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 55.50ms
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,17:06:39 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,17:06:39 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,17:06:39 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': [None], 'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,17:06:39 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,17:06:39 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,17:06:40 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,17:06:40 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 564.97ms
2020-05-11,17:13:45 [CRITICAL] (app.py:app:117): Exiting on signal 2...
2020-05-11,17:13:45 [INFO] (app.py:app:123): Shutting down TabPy...
2020-05-11,17:13:45 [INFO] (app.py:app:123): Shutting down TabPy...
2020-05-11,20:28:07 [DEBUG] (app.py:app:206): Parameter port set to "9004" from default value
2020-05-11,20:28:07 [DEBUG] (app.py:app:206): Parameter server_version set to "1.0.0" from default value
2020-05-11,20:28:07 [DEBUG] (app.py:app:206): Parameter evaluate_timeout set to "30" from default value
2020-05-11,20:28:07 [DEBUG] (app.py:app:206): Parameter upload_dir set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tmp/query_objects" from default value
2020-05-11,20:28:07 [DEBUG] (app.py:app:206): Parameter transfer_protocol set to "http" from default value
2020-05-11,20:28:07 [DEBUG] (app.py:app:212): Parameter certificate_file is not set
2020-05-11,20:28:07 [DEBUG] (app.py:app:212): Parameter key_file is not set
2020-05-11,20:28:07 [DEBUG] (app.py:app:206): Parameter state_file_path set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server" from default value
2020-05-11,20:28:07 [DEBUG] (app.py:app:206): Parameter static_path set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server/static" from default value
2020-05-11,20:28:07 [DEBUG] (app.py:app:212): Parameter TABPY_PWD_FILE is not set
2020-05-11,20:28:07 [DEBUG] (app.py:app:206): Parameter log_request_context set to "false" from default value
2020-05-11,20:28:07 [DEBUG] (app.py:app:206): Parameter max_request_size_in_mb set to "100" from default value
2020-05-11,20:28:07 [INFO] (app.py:app:436): Loading state from state file /Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server/state.ini
2020-05-11,20:28:07 [DEBUG] (app.py:app:315): Static pages folder set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server/static"
2020-05-11,20:28:07 [INFO] (app.py:app:334): Password file is not specified: Authentication is not enabled
2020-05-11,20:28:07 [INFO] (app.py:app:348): Call context logging is disabled
2020-05-11,20:28:07 [INFO] (app.py:app:125): Initializing TabPy...
2020-05-11,20:28:07 [DEBUG] (selector_events.py:selector_events:58): Using selector: KqueueSelector
2020-05-11,20:28:07 [INFO] (callbacks.py:callbacks:43): Initializing TabPy Server...
2020-05-11,20:28:07 [DEBUG] (state.py:state:596): Loading option 'None' from section [Query Objects Service Versions]...
2020-05-11,20:28:07 [DEBUG] (state.py:state:616): Returning value '[]'
2020-05-11,20:28:07 [DEBUG] (state.py:state:148): Collected endpoints: {}
2020-05-11,20:28:07 [INFO] (app.py:app:129): Done initializing TabPy.
2020-05-11,20:28:07 [INFO] (app.py:app:83): Setting max request size to 104857600 bytes
2020-05-11,20:28:07 [INFO] (callbacks.py:callbacks:64): Initializing models...
2020-05-11,20:28:07 [DEBUG] (state.py:state:596): Loading option 'None' from section [Query Objects Service Versions]...
2020-05-11,20:28:07 [DEBUG] (state.py:state:616): Returning value '[]'
2020-05-11,20:28:07 [DEBUG] (state.py:state:148): Collected endpoints: {}
2020-05-11,20:28:07 [INFO] (app.py:app:107): Web service listening on port 9004
2020-05-11,20:28:12 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:28:12 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:28:12 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:28:12 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:28:12 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:28:12 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:28:12 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:28:12 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:28:12 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:28:12 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:28:12 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,20:28:12 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,20:28:12 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 500.18ms
2020-05-11,20:28:13 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:28:13 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:28:13 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:28:13 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:28:13 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:28:13 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:28:13 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:28:13 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:28:13 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:28:13 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:28:13 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'F2': ['prep_string_type'], 'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,20:28:13 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,20:28:13 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 31.84ms
2020-05-11,20:29:01 [CRITICAL] (app.py:app:117): Exiting on signal 2...
2020-05-11,20:29:01 [INFO] (app.py:app:123): Shutting down TabPy...
2020-05-11,20:29:01 [INFO] (app.py:app:123): Shutting down TabPy...
2020-05-11,20:29:06 [DEBUG] (app.py:app:206): Parameter port set to "9004" from default value
2020-05-11,20:29:06 [DEBUG] (app.py:app:206): Parameter server_version set to "1.0.0" from default value
2020-05-11,20:29:06 [DEBUG] (app.py:app:206): Parameter evaluate_timeout set to "30" from default value
2020-05-11,20:29:06 [DEBUG] (app.py:app:206): Parameter upload_dir set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tmp/query_objects" from default value
2020-05-11,20:29:06 [DEBUG] (app.py:app:206): Parameter transfer_protocol set to "http" from default value
2020-05-11,20:29:06 [DEBUG] (app.py:app:212): Parameter certificate_file is not set
2020-05-11,20:29:06 [DEBUG] (app.py:app:212): Parameter key_file is not set
2020-05-11,20:29:06 [DEBUG] (app.py:app:206): Parameter state_file_path set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server" from default value
2020-05-11,20:29:06 [DEBUG] (app.py:app:206): Parameter static_path set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server/static" from default value
2020-05-11,20:29:06 [DEBUG] (app.py:app:212): Parameter TABPY_PWD_FILE is not set
2020-05-11,20:29:06 [DEBUG] (app.py:app:206): Parameter log_request_context set to "false" from default value
2020-05-11,20:29:06 [DEBUG] (app.py:app:206): Parameter max_request_size_in_mb set to "100" from default value
2020-05-11,20:29:06 [INFO] (app.py:app:436): Loading state from state file /Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server/state.ini
2020-05-11,20:29:06 [DEBUG] (app.py:app:315): Static pages folder set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server/static"
2020-05-11,20:29:06 [INFO] (app.py:app:334): Password file is not specified: Authentication is not enabled
2020-05-11,20:29:06 [INFO] (app.py:app:348): Call context logging is disabled
2020-05-11,20:29:06 [INFO] (app.py:app:125): Initializing TabPy...
2020-05-11,20:29:06 [DEBUG] (selector_events.py:selector_events:58): Using selector: KqueueSelector
2020-05-11,20:29:06 [INFO] (callbacks.py:callbacks:43): Initializing TabPy Server...
2020-05-11,20:29:06 [DEBUG] (state.py:state:596): Loading option 'None' from section [Query Objects Service Versions]...
2020-05-11,20:29:06 [DEBUG] (state.py:state:616): Returning value '[]'
2020-05-11,20:29:06 [DEBUG] (state.py:state:148): Collected endpoints: {}
2020-05-11,20:29:06 [INFO] (app.py:app:129): Done initializing TabPy.
2020-05-11,20:29:06 [INFO] (app.py:app:83): Setting max request size to 104857600 bytes
2020-05-11,20:29:06 [INFO] (callbacks.py:callbacks:64): Initializing models...
2020-05-11,20:29:06 [DEBUG] (state.py:state:596): Loading option 'None' from section [Query Objects Service Versions]...
2020-05-11,20:29:06 [DEBUG] (state.py:state:616): Returning value '[]'
2020-05-11,20:29:06 [DEBUG] (state.py:state:148): Collected endpoints: {}
2020-05-11,20:29:06 [INFO] (app.py:app:107): Web service listening on port 9004
2020-05-11,20:29:57 [CRITICAL] (app.py:app:117): Exiting on signal 2...
2020-05-11,20:29:58 [INFO] (app.py:app:123): Shutting down TabPy...
2020-05-11,20:29:58 [INFO] (app.py:app:123): Shutting down TabPy...
2020-05-11,20:30:20 [DEBUG] (app.py:app:206): Parameter port set to "9004" from default value
2020-05-11,20:30:20 [DEBUG] (app.py:app:206): Parameter server_version set to "1.0.0" from default value
2020-05-11,20:30:20 [DEBUG] (app.py:app:206): Parameter evaluate_timeout set to "30" from default value
2020-05-11,20:30:20 [DEBUG] (app.py:app:206): Parameter upload_dir set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tmp/query_objects" from default value
2020-05-11,20:30:20 [DEBUG] (app.py:app:206): Parameter transfer_protocol set to "http" from default value
2020-05-11,20:30:20 [DEBUG] (app.py:app:212): Parameter certificate_file is not set
2020-05-11,20:30:20 [DEBUG] (app.py:app:212): Parameter key_file is not set
2020-05-11,20:30:20 [DEBUG] (app.py:app:206): Parameter state_file_path set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server" from default value
2020-05-11,20:30:20 [DEBUG] (app.py:app:206): Parameter static_path set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server/static" from default value
2020-05-11,20:30:20 [DEBUG] (app.py:app:212): Parameter TABPY_PWD_FILE is not set
2020-05-11,20:30:20 [DEBUG] (app.py:app:206): Parameter log_request_context set to "false" from default value
2020-05-11,20:30:20 [DEBUG] (app.py:app:206): Parameter max_request_size_in_mb set to "100" from default value
2020-05-11,20:30:20 [INFO] (app.py:app:436): Loading state from state file /Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server/state.ini
2020-05-11,20:30:20 [DEBUG] (app.py:app:315): Static pages folder set to "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tabpy/tabpy_server/static"
2020-05-11,20:30:20 [INFO] (app.py:app:334): Password file is not specified: Authentication is not enabled
2020-05-11,20:30:20 [INFO] (app.py:app:348): Call context logging is disabled
2020-05-11,20:30:20 [INFO] (app.py:app:125): Initializing TabPy...
2020-05-11,20:30:20 [DEBUG] (selector_events.py:selector_events:58): Using selector: KqueueSelector
2020-05-11,20:30:20 [INFO] (callbacks.py:callbacks:43): Initializing TabPy Server...
2020-05-11,20:30:20 [DEBUG] (state.py:state:596): Loading option 'None' from section [Query Objects Service Versions]...
2020-05-11,20:30:20 [DEBUG] (state.py:state:616): Returning value '[]'
2020-05-11,20:30:20 [DEBUG] (state.py:state:148): Collected endpoints: {}
2020-05-11,20:30:20 [INFO] (app.py:app:129): Done initializing TabPy.
2020-05-11,20:30:20 [INFO] (app.py:app:83): Setting max request size to 104857600 bytes
2020-05-11,20:30:20 [INFO] (callbacks.py:callbacks:64): Initializing models...
2020-05-11,20:30:20 [DEBUG] (state.py:state:596): Loading option 'None' from section [Query Objects Service Versions]...
2020-05-11,20:30:20 [DEBUG] (state.py:state:616): Returning value '[]'
2020-05-11,20:30:20 [DEBUG] (state.py:state:148): Collected endpoints: {}
2020-05-11,20:30:20 [INFO] (app.py:app:107): Web service listening on port 9004
2020-05-11,20:30:25 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:30:25 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:30:25 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:30:25 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:30:25 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:30:25 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:25 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:30:25 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:25 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:30:25 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:25 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,20:30:25 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,20:30:26 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 465.24ms
2020-05-11,20:30:26 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:30:26 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:30:26 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:30:26 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:30:26 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:30:26 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:26 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:30:26 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:26 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:30:26 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:26 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,20:30:26 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,20:30:26 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 30.78ms
2020-05-11,20:30:26 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:30:26 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:30:26 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:30:26 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:30:26 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:30:26 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:26 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:30:26 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:26 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:30:26 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:26 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,20:30:26 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,20:30:26 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,20:30:27 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,20:30:27 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 1008.03ms
2020-05-11,20:30:31 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:30:31 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:30:31 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:30:31 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:30:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:30:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:30:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:30:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:31 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,20:30:31 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,20:30:31 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 33.12ms
2020-05-11,20:30:31 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:30:31 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:30:31 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:30:31 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:30:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:30:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:30:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:30:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:31 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,20:30:31 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,20:30:31 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 30.79ms
2020-05-11,20:30:31 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:30:31 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:30:31 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:30:31 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:30:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:30:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:30:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:31 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:30:31 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:31 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,20:30:31 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,20:30:31 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,20:30:32 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,20:30:32 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 723.53ms
2020-05-11,20:30:36 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:30:36 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:30:36 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:30:36 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:30:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:30:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:30:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:30:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:36 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,20:30:36 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,20:30:36 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 29.71ms
2020-05-11,20:30:36 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:30:36 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:30:36 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:30:36 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:30:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:30:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:30:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:30:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:36 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,20:30:36 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,20:30:36 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 38.21ms
2020-05-11,20:30:36 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:30:36 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:30:36 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:30:36 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:30:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:30:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:30:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:36 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:30:36 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:30:36 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,20:30:36 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
 
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,20:30:36 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,20:30:37 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,20:30:37 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 653.06ms
2020-05-11,20:31:44 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:31:44 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:31:44 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:31:44 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:31:44 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:31:44 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:31:44 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:31:44 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:31:44 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:31:44 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:31:44 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n    print(df)\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,20:31:44 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
     print(df)
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,20:31:44 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 30.26ms
2020-05-11,20:31:44 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:31:44 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:31:44 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:31:44 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:31:44 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:31:44 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:31:44 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:31:44 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:31:44 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:31:44 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:31:44 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n    print(df)\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,20:31:44 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
     print(df)
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,20:31:44 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 30.70ms
2020-05-11,20:31:44 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:31:44 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:31:44 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:31:44 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:31:44 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:31:44 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:31:44 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:31:44 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:31:44 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:31:44 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:31:44 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n    print(df)\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,20:31:44 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
     print(df)
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,20:31:44 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,20:31:44 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,20:31:44 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 777.55ms
2020-05-11,20:32:10 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:32:10 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:32:10 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:32:10 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:32:10 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:32:10 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:32:10 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:32:10 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:32:10 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:32:10 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:32:10 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n    print(df)\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,20:32:10 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
     print(df)
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,20:32:10 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 31.11ms
2020-05-11,20:32:10 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:32:10 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:32:10 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:32:10 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:32:10 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:32:10 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:32:10 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:32:10 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:32:10 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:32:10 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:32:10 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n    print(df)\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
2020-05-11,20:32:10 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 def get_output_schema():
 	return '0eae8527-abd9-4fff-93f2-96bc3b6782fa'
 def prep_string():
 	return ['prep_string_type']
 def prep_bool():
 	return ['prep_bool_type']
 def prep_int():
 	return ['prep_int_type']
 def prep_decimal():
     return ['prep_decimal_type']
 def prep_date():
 	return ['prep_date_type']
 def prep_datetime():
 	return ['prep_datetime_type']
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
     print(df)
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 def get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):
     import inspect
     if len(inspect.getfullargspec(get_output_schema).args) == 0:
         return get_output_schema()
     else:
         return get_output_schema(df)
 result_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))
 return result_schema_output.to_dict(orient='split') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output

2020-05-11,20:32:10 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 35.97ms
2020-05-11,20:32:10 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:32:10 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:32:10 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:32:10 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:32:10 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:32:10 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:32:10 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:32:10 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:32:10 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:32:10 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:32:10 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ["https://api.instarsuite.com/norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT TOP 100 INGR_CHANNELS.ATTR_NAME, CALC_DPS.UNIT_RTG, CALC_DPS.UNIT_RTGPCT, CALC_DPS.UNIT_SHR FROM CALC_DPS, INGR_CHANNELS WHERE INGR_CHANNELS.ATTR_ID LIKE '1:%' ORDER  BY CALC_DPS.UNIT_RTG DESC LIMIT 300 OFFSET 0&tqx=reqId:9"]}}, 'script': 'import pandas as pd\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n    print(df)\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            if first_row_csv[count].isnumeric():\n                dict[i] = prep_int()\n            else:\n                dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\nexecution_result = get_query_csv(pd.DataFrame(_arg1))\nreturn execution_result.to_dict(orient=\'list\') if isinstance(execution_result, pd.DataFrame) else execution_result\n'}'...
2020-05-11,20:32:10 [INFO] (base_handler.py:base_handler:121): function to evaluate=def _user_script(tabpy, _arg1):
 import pandas as pd
 import requests
 import pandas as pd
 
 keys_csv = ''
 first_row_csv = ''
 
 def set_first_row(keys):
     global first_row_csv # Needed to modify global copy of globvar
     first_row_csv = input
 
 def get_first_row():
     global first_row_csv
     return first_row_csv
 
 
 def set_globvar(keys,first_row):
     global keys_csv  # Needed to modify global copy of globvar
     global first_row_csv
     print(keys)
     print(first_row)
     if keys == "Init":
         keys_csv = keys
     else:
         keys_csv = keys
     first_row_csv = first_row
 
 def get_globvar():
     global keys_csv
     return keys_csv
 
 
 def get_query_csv(url):
     global first_row_csv
     print("######## VAMONOS KILLO $$$$$")
     url = f'{url.iloc[0]["url"]}'
 
     response = requests.get(url)
     iter = response.iter_lines()
 
 
     set_globvar(next(iter).decode('utf-8').split(';'),next(iter).decode('utf-8').split(';'))
 
     # iter = response.iter_lines()
     # a = next(iter)
     data = list()
 
     for i in iter:
         a = i.decode('utf-8').split(';')
         print(a)
         data.append(i.decode('utf-8').split(';'))
     df = pd.DataFrame(data, columns=get_globvar())
     print(df)
     return df
     #return pd.DataFrame(first_row_csv)
 
 
 def get_output_schema():
     global keys_csv
     global first_row_csv
     print("#########HOLALA#####")
     if not "keys_csv" in globals():
         set_globvar("Init",'')
     print(globals())
     keys_csv = get_globvar()
 
     first_row_csv = get_first_row()
 
     dict = {}
 
 
     if keys_csv == 'Init':
         for i in keys_csv:
             dict[i] = prep_string()
     else:
         count = 0
         for i in keys_csv:
             if first_row_csv[count].isnumeric():
                 dict[i] = prep_int()
             else:
                 dict[i] = prep_string()
             count = count + 1
     return pd.DataFrame(dict)
 execution_result = get_query_csv(pd.DataFrame(_arg1))
 return execution_result.to_dict(orient='list') if isinstance(execution_result, pd.DataFrame) else execution_result

2020-05-11,20:32:10 [DEBUG] (connectionpool.py:connectionpool:941): Starting new HTTPS connection (1): api.instarsuite.com:443
2020-05-11,20:32:10 [DEBUG] (connectionpool.py:connectionpool:442): https://api.instarsuite.com:443 "GET /norwaytvov/IADS.asmx/GetData?iads_params=name:NRK-NO-API-1;password:wySGA3M9h;idLang:EN;idApp:3000;outformat:CSV;skipmetadata:1&tq=SELECT%20TOP%20100%20INGR_CHANNELS.ATTR_NAME,%20CALC_DPS.UNIT_RTG,%20CALC_DPS.UNIT_RTGPCT,%20CALC_DPS.UNIT_SHR%20FROM%20CALC_DPS,%20INGR_CHANNELS%20WHERE%20INGR_CHANNELS.ATTR_ID%20LIKE%20'1:%25'%20ORDER%20%20BY%20CALC_DPS.UNIT_RTG%20DESC%20LIMIT%20300%20OFFSET%200&tqx=reqId:9 HTTP/1.1" 200 1406
2020-05-11,20:32:10 [INFO] (web.py:web:2250): 200 POST /evaluate (127.0.0.1) 554.54ms
2020-05-11,20:32:47 [DEBUG] (base_handler.py:base_handler:121): Checking if need to handle authentication
2020-05-11,20:32:47 [DEBUG] (base_handler.py:base_handler:121): Handling authentication
2020-05-11,20:32:47 [INFO] (base_handler.py:base_handler:121): Authentication is not a required feature for API "v1"
2020-05-11,20:32:47 [DEBUG] (state.py:state:492): Collecting Access-Control-Allow-Origin from state file ...
2020-05-11,20:32:47 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Origin' from section [Service Info]...
2020-05-11,20:32:47 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:32:47 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Headers' from section [Service Info]...
2020-05-11,20:32:47 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:32:47 [DEBUG] (state.py:state:596): Loading option 'Access-Control-Allow-Methods' from section [Service Info]...
2020-05-11,20:32:47 [DEBUG] (state.py:state:616): Returning value ''
2020-05-11,20:32:47 [DEBUG] (base_handler.py:base_handler:121): Processing POST request '{'data': {'_arg1': {'url': ['prep_string_type']}}, 'script': 'import pandas as pd\ndef get_output_schema():\n\treturn \'0eae8527-abd9-4fff-93f2-96bc3b6782fa\'\ndef prep_string():\n\treturn [\'prep_string_type\']\ndef prep_bool():\n\treturn [\'prep_bool_type\']\ndef prep_int():\n\treturn [\'prep_int_type\']\ndef prep_decimal():\n    return [\'prep_decimal_type\']\ndef prep_date():\n\treturn [\'prep_date_type\']\ndef prep_datetime():\n\treturn [\'prep_datetime_type\']\nimport requests\nimport pandas as pd\n\nkeys_csv = \'\'\nfirst_row_csv = \'\'\n\ndef set_first_row(keys):\n    global first_row_csv # Needed to modify global copy of globvar\n    first_row_csv = input\n\ndef get_first_row():\n    global first_row_csv\n    return first_row_csv\n\n\ndef set_globvar(keys,first_row):\n    global keys_csv  # Needed to modify global copy of globvar\n    global first_row_csv\n    print(keys)\n    print(first_row)\n    if keys == "Init":\n        keys_csv = keys\n    else:\n        keys_csv = keys\n    first_row_csv = first_row\n\ndef get_globvar():\n    global keys_csv\n    return keys_csv\n\n\ndef get_query_csv(url):\n    global first_row_csv\n    print("######## VAMONOS KILLO $$$$$")\n    url = f\'{url.iloc[0]["url"]}\'\n\n    response = requests.get(url)\n    iter = response.iter_lines()\n\n\n    set_globvar(next(iter).decode(\'utf-8\').split(\';\'),next(iter).decode(\'utf-8\').split(\';\'))\n\n    # iter = response.iter_lines()\n    # a = next(iter)\n    data = list()\n\n    for i in iter:\n        a = i.decode(\'utf-8\').split(\';\')\n        print(a)\n        data.append(i.decode(\'utf-8\').split(\';\'))\n    df = pd.DataFrame(data, columns=get_globvar())\n    print(df)\n    return df\n    #return pd.DataFrame(first_row_csv)\n\n\ndef get_output_schema():\n    global keys_csv\n    global first_row_csv\n    print("#########HOLALA#####")\n    if not "keys_csv" in globals():\n        set_globvar("Init",\'\')\n    print(globals())\n    keys_csv = get_globvar()\n\n    first_row_csv = get_first_row()\n\n    dict = {}\n\n\n    if keys_csv == \'Init\':\n        for i in keys_csv:\n            dict[i] = prep_string()\n    else:\n        count = 0\n        for i in keys_csv:\n            # if first_row_csv[count].isnumeric():\n            #     dict[i] = prep_int()\n            # else:\n            dict[i] = prep_string()\n            count = count + 1\n    return pd.DataFrame(dict)\ndef get_output_schema_5188084eafe649cf81246f84410dfb50(df = pd.DataFrame()):\n    import inspect\n    if len(inspect.getfullargspec(get_output_schema).args) == 0:\n        return get_output_schema()\n    else:\n        return get_output_schema(df)\nresult_schema_output = get_output_schema_5188084eafe649cf81246f84410dfb50(pd.DataFrame(_arg1))\nreturn result_schema_output.to_dict(orient=\'split\') if isinstance(result_schema_output, pd.DataFrame) else result_schema_output'}'...
